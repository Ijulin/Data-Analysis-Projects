/*** Project 1: Pricing Models for Tropicana 64 oz. ***/
libname mydir '/home/u59305518/BUMK742/Project1';


data temp;            
set mydir.tropic;    
 
/* Create log-transformation of sales and price */
Bottlenumber=quant/64;
lq=log(Bottlenumber);
lp=log(price);

/* Create three dummy variables for the four quarters */
/* treating the fourth quarter as the baseline */
qrt1=0;
qrt2=0;
qrt3=0;
if (week>=1 and week<=13) or (week>=53 and week<=65) then qrt1=1;
if (week>=14 and week<=26) or (week>=66 and week<=78) then qrt2=1;
if (week>=27 and week<=39) or (week>=79 and week<=91) then qrt3=1;

/* Creating a dummy variable for price ending with 9 cents */
/* Note that in the first statement, PRICE is converted from */
/* a numerical variable into a character variable, because */
/* the function 'substr' only apply to character variables. */

chprc=put(price,4.2);
if substr(chprc,4,1)="9" then end9=1;
else end9=0;

IF (Week>=1 AND Week<=52) THEN year1=1;
Else year1=0;

/* Create store dummy variables to capture differences in baseline */
/* sales across stores caused by factors not included in the dataset */
/* (e.g., store size, average income in the trading area).*/
store1=0;
store2=0;
store3=0;
store4=0;
store5=0;
store6=0;
store7=0;
store8=0;
store9=0;
store10=0;
store11=0;
store12=0;
store13=0;
store14=0;
if store=2 then store1=1;
if store=14 then store2=1;
if store=32 then store3=1;
if store=52 then store4=1;
if store=62 then store5=1;
if store=68 then store6=1;
if store=71 then store7=1;
if store=72 then store8=1;
if store=93 then store9=1;
if store=95 then store10=1;
if store=111 then store11=1;
if store=123 then store12=1;
if store=124 then store13=1;
if store=130 then store14=1;

/* Check whether there are differences in the average sales */
/* level across the 15 stores. */
proc means;
var quant;
class store;

/* Estimate alternative log-log and semi-log models */
proc reg;
*model lq = price ;             /* semi-log models*/
*model lq = price deal;             /* semi-log models deal*/
*model lq = price year1;   /* semi-log models year1*/
*model lq = price year1 deal;   /* semi-log models qrt deal*/
*model lq = price store1 store2 store3 store4 store5 store6 store7 store8 store9 store10 store11 store12 store13 store14 ;             /* semi-log models store*/
*model lq = price store1 store2 store3 store4 store5 store6 store7 store8 store9 store10 store11 store12 store13 store14  deal;             /* semi-log models store deal*/
*model lq = price store1 store2 store3 store4 store5 store6 store7 store8 store9 store10 store11 store12 store13 store14  year1;             /* semi-log models store qrt*/
*model lq = price store1-store14 year1 deal;     /* semi-log models store qrt deal*/



*model lq = price week;             /* semi-log models*/
*model lq = price deal week;  
*model lq = price year1 week;   /* semi-log models year1*/
*model lq = price year1 deal week;   /* semi-log models qrt deal*/
*model lq = price store1-store14 week;             /* semi-log models store*/
*model lq = price store1-store14  deal week;             /* semi-log models store deal*/
*model lq = price store1-store14  year1 week;             /* semi-log models store qrt*/
*model lq = price store1-store14 year1 deal week;     /* semi-log models store qrt deal*/



*model lq = lp ;             /* log-log models*/
*model lq = lp deal;             /* log-log models deal*/
*model lq = lp year1;   /* log-log models year1*/
*model lq = lp year1 deal;   /* log-log models year1 deal*/
*model lq = lp store1 store2 store3 store4 store5 store6 store7 store8 store9 store10 store11 store12 store13 store14 ;             /* log-log models store*/
*model lq = lp store1 store2 store3 store4 store5 store6 store7 store8 store9 store10 store11 store12 store13 store14  deal;             /* log-log models store deal*/
*model lq = lp store1 store2 store3 store4 store5 store6 store7 store8 store9 store10 store11 store12 store13 store14  year1;             /* log-log models store yaer1*/
*model lq = lp store1 store2 store3 store4 store5 store6 store7 store8 store9 store10 store11 store12 store13 store14  year1 deal;     /* log-log models store year1 deal*/

*model lq = lp week;             /* semi-log models*/
*model lq = lp deal week;  
*model lq = lp year1 week;   /* semi-log models year1*/
*model lq = lp year1 deal week;   /* semi-log models qrt deal*/
*model lq = lp store1-store14 week;             /* semi-log models store*/
*model lq = lp store1-store14  deal week;             /* semi-log models store deal*/
*model lq = lp store1-store14  year1 week;             /* semi-log models store qrt*/
*model lq = lp store1-store14 year1 deal week;     /* semi-log models store qrt deal*/

model lq=lp end9 ;
model lq=lp deal end9;
model lq=lp deal end9 week;
model lq=lp deal end9 week qrt1-qrt3;
model lq=store1-store14 lp deal end9 week qrt1-qrt3;

model lq=lp end9 year1;
model lq=lp deal end9 Year1;
model lq=lp deal end9 week year1;
model lq=lp deal end9 week qrt1-qrt3 year1;
model lq=store1-store14 lp deal end9 week qrt1-qrt3 year1; 

model lq=price end9;
model lq=price deal end9;
model lq=price deal end9 week;
model lq=price deal end9 week qrt1-qrt3;
model lq=store1-store14 price deal end9 week qrt1-qrt3; /*best*/

model lq=price end9 year1;
model lq=price deal end9 year1;
model lq=price deal end9 week year1;
model lq=price deal end9 week qrt1-qrt3 year1;
model lq=store1-store14 price deal end9 week qrt1-qrt3 year1;

run; 

proc reg;
model lq = price ;             /* semi-log models*/
model lq = price deal;             /* semi-log models deal*/
model lq = price week;    /* semi-log models week*/
model lq = price week deal;    /* semi-log models week deal*/
model lq = price qrt1 qrt2 qrt3;   /* semi-log models qrt*/
model lq = price qrt1 qrt2 qrt3 deal;   /* semi-log models qrt deal*/
model lq = price week qrt1 qrt2 qrt3;             /* semi-log models week qrt*/
model lq = price week qrt1 qrt2 qrt3 deal; /* semi-log models week qrt deal*/
model lq = price store;             /* semi-log models store*/
model lq = price store deal;             /* semi-log models store deal*/
model lq = price store week;             /* semi-log models store week*/
model lq = price store week deal;             /* semi-log models week deal*/
model lq = price store qrt1 qrt2 qrt3;             /* semi-log models store qrt*/
model lq = price store qrt1 qrt2 qrt3 deal;     /* semi-log models store qrt deal*/
model lq = price week store qrt1 qrt2 qrt3; /* semi-log models week store qrt*/
model lq = deal price week store qrt1 qrt2 qrt3;/* semi-log models */

model lq = lp ;             /* log-log models*/
model lq = lp deal;             /* log-log models deal*/
model lq = lp week;    /* log-log models week*/
model lq = lp week deal;    /* log-log models week deal*/
model lq = lp qrt1 qrt2 qrt3;   /* log-log models qrt*/
model lq = lp qrt1 qrt2 qrt3 deal;   /* log-log models qrt deal*/
model lq = lp week qrt1 qrt2 qrt3;             /* log-log models week qrt*/
model lq = lp week qrt1 qrt2 qrt3 deal; /* log-log models week qrt deal*/
model lq = lp store;             /* log-log models store*/
model lq = lp store deal;             /* log-log models store deal*/
model lq = lp store week;             /* log-log models store week*/
model lq = lp store week deal;             /* log-log models week deal*/
model lq = lp store qrt1 qrt2 qrt3;             /* log-log models store qrt*/
model lq = lp store qrt1 qrt2 qrt3 deal;     /* log-log models store qrt deal*/
model lq = lp week store qrt1 qrt2 qrt3; /* log-log models week store qrt*/
model lq = lp deal week store qrt1 qrt2 qrt3;/* log-log models */

RUN;
